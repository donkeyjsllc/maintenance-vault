<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Maintenance Vault</title>
    
    <link rel="manifest" href="manifest.json">

    <script src="https://cdn.tailwindcss.com"></script>

    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">

    <style>
        /* Custom scrollbar for a sleek look */
        ::-webkit-scrollbar { width: 8px; }
        ::-webkit-scrollbar-track { background: #1a202c; }
        ::-webkit-scrollbar-thumb { background: #4a5568; border-radius: 4px; }
    </style>
</head>

<body class="bg-gray-900 text-gray-100 font-sans min-h-screen p-4 sm:p-6 pb-24">

    <header class="max-w-3xl mx-auto mb-8 flex items-center justify-between border-b border-gray-700 pb-4">
        <div>
            <h1 class="text-3xl font-bold text-blue-400 tracking-tight">
                <i class="fas fa-shield-alt mr-2"></i>MaintVault
            </h1>
            <p class="text-gray-500 text-xs mt-1 font-mono uppercase">Home ‚Ä¢ Auto ‚Ä¢ Equipment</p>
        </div>
        <div class="text-right">
            <div class="text-xs text-gray-500 uppercase font-bold">Total Items</div>
            <div id="total-count" class="text-2xl font-bold text-white">0</div>
        </div>
    </header>

    <div class="max-w-3xl mx-auto bg-gray-800 rounded-xl p-5 shadow-lg border border-gray-700 mb-8">
        <h2 class="text-lg font-semibold mb-4 text-blue-300 flex items-center">
            <i class="fas fa-plus-circle mr-2"></i> Add New Item
        </h2>
        
        <div class="grid grid-cols-1 md:grid-cols-2 gap-4">
            
            <div>
                <label class="block text-xs text-gray-400 mb-1 uppercase">Item Name</label>
                <input type="text" id="itemName" placeholder="e.g., Silverado Oil, AC Filter" 
                    class="w-full bg-gray-900 border border-gray-600 rounded p-2 focus:border-blue-500 focus:outline-none text-white placeholder-gray-600">
            </div>

            <div>
                <label class="block text-xs text-gray-400 mb-1 uppercase">Category</label>
                <select id="itemCategory" class="w-full bg-gray-900 border border-gray-600 rounded p-2 focus:border-blue-500 focus:outline-none text-white">
                    <option value="Vehicle">üöó Vehicle (Silverado/Car)</option>
                    <option value="Home">üè† House (AC/Plumbing)</option>
                    <option value="Outdoor">üöú Outdoor (Mower/Tools)</option>
                    <option value="Electronics">üíª Electronics</option>
                </select>
            </div>

            <div>
                <label class="block text-xs text-gray-400 mb-1 uppercase">Part # / Size</label>
                <input type="text" id="itemPart" placeholder="e.g., PF63 or 20x20x1" 
                    class="w-full bg-gray-900 border border-gray-600 rounded p-2 focus:border-blue-500 focus:outline-none text-white font-mono text-yellow-400">
            </div>

            <div>
                <label class="block text-xs text-gray-400 mb-1 uppercase">Cost ($)</label>
                <input type="number" id="itemCost" placeholder="0.00" 
                    class="w-full bg-gray-900 border border-gray-600 rounded p-2 focus:border-blue-500 focus:outline-none text-white">
            </div>
        </div>

        <div class="mt-4">
            <label class="block text-xs text-gray-400 mb-1 uppercase">Notes / Location</label>
            <input type="text" id="itemNotes" placeholder="e.g., Garage Shelf, Bought at Lowe's" 
                class="w-full bg-gray-900 border border-gray-600 rounded p-2 focus:border-blue-500 focus:outline-none text-gray-300 text-sm">
        </div>

        <button onclick="addItem()" class="w-full mt-6 bg-blue-600 hover:bg-blue-500 text-white font-bold py-3 rounded-lg shadow-md transition-all active:scale-95">
            SAVE TO VAULT
        </button>
    </div>

    <div id="vaultList" class="max-w-3xl mx-auto grid grid-cols-1 gap-4">
        </div>

    <footer class="max-w-3xl mx-auto mt-12 pt-6 border-t border-gray-700 text-center pb-10">
        <div class="flex justify-center gap-4 mb-4">
            <button onclick="exportData()" class="px-4 py-2 bg-green-700 hover:bg-green-600 rounded text-sm font-semibold shadow">
                <i class="fas fa-file-export mr-1"></i> Export CSV
            </button>
            
            <label class="px-4 py-2 bg-gray-600 hover:bg-gray-500 rounded text-sm font-semibold shadow cursor-pointer">
                <i class="fas fa-file-import mr-1"></i> Import CSV
                <input type="file" onchange="importData(event)" class="hidden" accept=".csv">
            </label>
        </div>
        <p class="text-gray-600 text-xs italic">
            ‚ö†Ô∏è Warning: Clearing browser cache will delete data. Please Export regularly.
        </p>
    </footer>

    <script>
        // 1. Initialize & Load
        document.addEventListener('DOMContentLoaded', loadVault);

        function loadVault() {
            const data = JSON.parse(localStorage.getItem('maintVaultData')) || [];
            const list = document.getElementById('vaultList');
            const countDisplay = document.getElementById('total-count');
            
            list.innerHTML = '';
            countDisplay.innerText = data.length;

            if (data.length === 0) {
                list.innerHTML = `<div class="text-center text-gray-500 py-10 italic">Vault is empty. Add your first item above!</div>`;
                return;
            }

            data.forEach((item, index) => {
                // Determine Icon based on Category
                let icon = 'fa-box';
                let color = 'text-gray-400';
                if(item.category === 'Vehicle') { icon = 'fa-car'; color = 'text-blue-400'; }
                if(item.category === 'Home') { icon = 'fa-home'; color = 'text-green-400'; }
                if(item.category === 'Outdoor') { icon = 'fa-leaf'; color = 'text-yellow-400'; }
                if(item.category === 'Electronics') { icon = 'fa-laptop'; color = 'text-purple-400'; }

                const card = `
                    <div class="bg-gray-800 rounded-lg p-4 border-l-4 border-gray-700 hover:border-blue-500 transition-all shadow-md relative group">
                        <button onclick="deleteItem(${index})" class="absolute top-2 right-2 text-gray-600 hover:text-red-500 p-2">
                            <i class="fas fa-trash"></i>
                        </button>
                        
                        <div class="flex items-start">
                            <div class="mt-1 mr-4 ${color} text-2xl">
                                <i class="fas ${icon}"></i>
                            </div>
                            <div class="flex-1">
                                <div class="text-xs text-gray-500 font-bold uppercase tracking-wider mb-1">${item.category}</div>
                                <h3 class="text-xl font-bold text-white leading-tight mb-1">${item.name}</h3>
                                <div class="font-mono text-yellow-400 text-lg mb-2 bg-gray-900 inline-block px-2 rounded border border-gray-700">
                                    ${item.part}
                                </div>
                                <div class="text-sm text-gray-400">
                                    <span class="mr-3"><i class="fas fa-tag mr-1"></i> $${item.cost}</span>
                                    <span><i class="fas fa-info-circle mr-1"></i> ${item.notes}</span>
                                </div>
                            </div>
                        </div>
                    </div>
                `;
                list.innerHTML += card;
            });
        }

        // 2. Add New Item
        function addItem() {
            const name = document.getElementById('itemName').value;
            const cat = document.getElementById('itemCategory').value;
            const part = document.getElementById('itemPart').value;
            const cost = document.getElementById('itemCost').value;
            const notes = document.getElementById('itemNotes').value;

            if (!name || !part) return alert("Please enter at least a Name and Part Number.");

            const newItem = { name, category: cat, part, cost: cost || '0', notes: notes || '' };
            
            const data = JSON.parse(localStorage.getItem('maintVaultData')) || [];
            data.push(newItem); // Add to top
            localStorage.setItem('maintVaultData', JSON.stringify(data));
            
            // Clear inputs
            document.getElementById('itemName').value = '';
            document.getElementById('itemPart').value = '';
            document.getElementById('itemCost').value = '';
            document.getElementById('itemNotes').value = '';
            
            loadVault();
        }

        // 3. Delete Item
        function deleteItem(index) {
            if(!confirm("Delete this item?")) return;
            const data = JSON.parse(localStorage.getItem('maintVaultData')) || [];
            data.splice(index, 1);
            localStorage.setItem('maintVaultData', JSON.stringify(data));
            loadVault();
        }

        // 4. Export to CSV
        function exportData() {
            const data = JSON.parse(localStorage.getItem('maintVaultData')) || [];
            if (data.length === 0) return alert("Nothing to export!");
            
            let csv = "Name,Category,Part Number,Cost,Notes\n";
            data.forEach(item => {
                csv += `"${item.name}","${item.category}","${item.part}","${item.cost}","${item.notes}"\n`;
            });

            const blob = new Blob([csv], { type: 'text/csv' });
            const url = window.URL.createObjectURL(blob);
            const a = document.createElement('a');
            a.href = url;
            a.download = 'MaintenanceVault_Backup.csv';
            a.click();
        }

        // 5. Import CSV
        function importData(event) {
            const file = event.target.files[0];
            if (!file) return;

            const reader = new FileReader();
            reader.onload = function(e) {
                const text = e.target.result;
                const lines = text.split('\n');
                const newData = [];
                
                // Skip header row (i=1)
                for(let i=1; i<lines.length; i++) {
                    if(lines[i].trim() === '') continue;
                    // Simple regex to handle quotes in CSV
                    const cols = lines[i].match(/(".*?"|[^",\s]+)(?=\s*,|\s*$)/g) || [];
                    const cleanCols = cols.map(c => c.replace(/^"|"$/g, '')); // Remove quotes
                    
                    if(cleanCols.length >= 3) {
                        newData.push({
                            name: cleanCols[0],
                            category: cleanCols[1] || 'General',
                            part: cleanCols[2],
                            cost: cleanCols[3] || '0',
                            notes: cleanCols[4] || ''
                        });
                    }
                }
                
                if(confirm(`Import found ${newData.length} items. This will replace your current list. Continue?`)) {
                    localStorage.setItem('maintVaultData', JSON.stringify(newData));
                    loadVault();
                }
            };
            reader.readAsText(file);
        }
    </script>
</body>
</html>

